<?xml version="1.0" encoding="UTF-8"?>
<server>

    <!--
        See:

        https://www.ibm.com/docs/en/was-liberty/nd?topic=dmal-deploying-jms-applications-liberty-use-mq-messaging-provider
        
        https://www.ibm.com/docs/en/ibm-mq/9.3?topic=adapter-liberty-mq-resource

        https://www.ibm.com/docs/en/ibm-mq/9.3?topic=adapter-configuration-resourceadapter-object-properties#q031660___libconfig

    -->

    <!-- 
        https://www.ibm.com/docs/en/ibm-mq/9.3?topic=adapter-configuration-resourceadapter-object-properties
    -->
    <wmqJmsClient supportMQExtensions="true" logWriterEnabled="true" reconnectionRetryCount="100"/>

    <variable name="wmqJmsClient.rar.location" value="${shared.resource.dir}/wmq.jmsra-9.3.5.0.rar"/>

    <connectionManager id="connectionManager" maxPoolSize="10" />

    <!-- 
        Read connectionNameList from environment variable.
    -->
    <variable name="connectionNameList" value="${CONNECTION_NAME_LIST}" />

    <variable name="channel" value="HAQMCHL"/>
    <variable name="queuemanager" value="NATIVEHAQM" />
    <variable name="transportType" value="CLIENT"/>
    <variable name="applicationName" value="Liberty Sample app"/>

    <!-- https://www.ibm.com/docs/en/ibm-mq/9.3?topic=jms-tls-cipherspecs-ciphersuites-in-mq-classes -->
    <variable name="sslCipherSuite" value="*TLS12ORHIGHER"/>

    <!-- 
        https://www.ibm.com/docs/en/ibm-mq/9.3?topic=adapter-configuring-resource-outbound-communication 
    -->
    <jmsConnectionFactory jndiName="jms/mqConnectionFactory" connectionManagerRef="connectionManager" >
        <properties.wmqJms
            connectionNameList="${connectionNameList}"
            channel="${channel}"
            queueManager="${queuemanager}"
            sslCipherSuite="${sslCipherSuite}"
            applicationName="${applicationName}"
            transportType="${transportType}"
        />
    </jmsConnectionFactory>

    <!-- 
        https://www.ibm.com/docs/en/ibm-mq/9.3?topic=adapter-configuring-resource-inbound-communication 
    -->
    <jmsActivationSpec id="liberty-sampleapp-1.0-SNAPSHOT/ListenerMDB" autoStart="true">
        <properties.wmqJms
            connectionNameList="${connectionNameList}"
            channel="${channel}"
            queueManager="${queuemanager}"
            sslCipherSuite="${sslCipherSuite}"
            applicationName="${applicationName}"
            transportType="${transportType}"
            destinationRef="jms/queue2"
            destinationType="javax.jms.Queue"
        />
    </jmsActivationSpec>

    <jmsQueue id="jms/queue1" jndiName="jms/queue1">
        <properties.wmqJms baseQueueName="QUEUE1" />
    </jmsQueue>

    <jmsQueue id="jms/queue2" jndiName="jms/queue2">
        <properties.wmqJms baseQueueName="QUEUE2" />
    </jmsQueue>

    <!-- logging traceSpecification="JMSApi=all:WAS.j2c=all:"/ -->
</server>